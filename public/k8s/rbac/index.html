<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="description" content="kubernetes Config">
<meta name="author" content="CloudNativeFolks">

<title>RBAC · kubedaily</title>

<link rel="canonical" href="https://kubedaily.com/k8s/rbac/">









<link rel="stylesheet" href="/scss/base.css" integrity="">



<link rel="stylesheet" href="/scss/theme/default.css" integrity="">



  <link rel="preconnect" href="https://-dsn.algolia.net" crossorigin />
  
  <link rel="stylesheet" href="/scss/component/docsearch.css" integrity=""/>

<link rel="manifest" href="/manifest.json">
<link rel="icon" href="/img/icon/favicon.ico">
<link rel="icon" href="/img/icon/icon-16.png" sizes="16x16" type="image/png">
<link rel="icon" href="/img/icon/icon-32.png" sizes="32x32" type="image/png">
<link rel="apple-touch-icon" href="/img/icon/icon-180.png" sizes="180x180">
<script async src="https://www.googletagmanager.com/gtag/js?id="></script>
<script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', '');
</script>
    <script 
     src="https://cdn.jsdelivr.net/npm/quizdown@latest/public/build/quizdown.js">
  </script>
  <script 
      src="https://cdn.jsdelivr.net/npm/quizdown@latest/public/build/extensions/quizdownKatex.js">
  </script>
  <script 
      src="https://cdn.jsdelivr.net/npm/quizdown@latest/public/build/extensions/quizdownHighlight.js">
  </script>
  <script>quizdown.register(quizdownHighlight).register(quizdownKatex).init()</script> 
  </head>
  <body>
    <header id="site-header">
  
  <div id="site-header-brand">
    <a href="/">kubedaily</a>
  </div>

  
  <div id="site-header-controls">
    
    <div class="dropdown">
      <button class="dropdown-btn" aria-haspopup="menu" aria-label="theme selector">
        <i class="icon icon-brightness"></i>
        <i class="icon icon-select"></i>
      </button>
      <ul role="menu" class="dropdown-menu">
        <li role="menuitem"><button class="color-scheme" data-value="light"><i class="icon icon-light-mode"></i> Light</button></li>
        <li role="menuitem"><button class="color-scheme" data-value="dark"><i class="icon icon-dark-mode"></i> Dark &nbsp;</button></li>
        <li role="menuitem"><button class="color-scheme" data-value="night"><i class="icon icon-night-mode"></i> Night</button></li>
      </ul>
    </div>

    
    <div class="dropdown">
      <button class="dropdown-btn" aria-haspopup="menu" aria-label="language selector">
        <i class="icon icon-translate"></i>
        <i class="icon icon-select"></i>
      </button>
      <ul role="menu" class="dropdown-menu">
        
          <li role="menuitem"><a href="#">English</a></li>
        
      </ul>
    </div>
  </div>

  
  <div id="site-header-menu">
    <nav>
      <ul>
        
        
        
          
          <li><a href="/" ><i class='icon icon-home'></i>Home</a></li>
        
          
          <li><a href="/docker/" ><i class='icon icons8-docker '></i>Docker</a></li>
        
          
          <li><a href="/containersecurity/" ><i class='icon icon-book'></i>ContainerSecurity</a></li>
        
          
          <li><a href="/k8s/"  class="active"><i class='icon icons8-kubernetes'></i>Kubernetes</a></li>
        
          
          <li><a href="/blog/" ><i class='icon icon-book'></i>blog</a></li>
        
          
          <li><a href="https://kubedaily.com/cloudnativetools/" ><i class='icon icon-book'></i>cloudnativetools</a></li>
        
      </ul>
    </nav>
  </div>

  

</header>
    
<div id="site-main-content-wrapper">
  
  
    <aside id="sidebar">
  <span class="btn-close"><i class="icon icon-close"></i></span>

  <div class="sticky"><strong class="sidebar-section">k8s</strong>
          
          <a class="sidebar-link " href="/k8s/overview/">
            
              Overview
            
          </a>

        <strong class="sidebar-section">⎈ kubernetes</strong>
          
          <a class="sidebar-link " href="/k8s/pre-requisit-for-this-lab/">
            
              Pre-requisit for this lab
            
          </a>

        
          
          <a class="sidebar-link " href="/k8s/basics-of-pod/">
            
              Basics of Pod
            
          </a>

        
          
          <a class="sidebar-link " href="/k8s/create-pod-with-command-and-arguments/">
            
              Create POD with Command and Arguments
            
          </a>

        
          
          <a class="sidebar-link " href="/k8s/multi-container-pods/">
            
              Multi-Container Pods
            
          </a>

        
          
          <a class="sidebar-link " href="/k8s/deployments-and-replication/">
            
              Deployments and replication
            
          </a>

        
          
          <a class="sidebar-link " href="/k8s/labels-and-selectors/">
            
              Labels and Selectors
            
          </a>

        
          
          <a class="sidebar-link " href="/k8s/kubernetes-service/">
            
              Kubernetes Service
            
          </a>

        
          
          <a class="sidebar-link " href="/k8s/service-type-nodeportclusteriploadbalancer/">
            
              Service Type - NodePort,ClusterIP,LoadBalancer
            
          </a>

        
          
          <a class="sidebar-link " href="/k8s/ingress-controller/">
            
              Ingress Controller
            
          </a>

        
          
          <a class="sidebar-link " href="/k8s/configmap/">
            
              ConfigMap
            
          </a>

        
  </div>
</aside>
  
  <main>
    <article id="article">
      <nav id="article-nav">
  <button id="article-nav-menu-btn"><i class="icon icon-menu"></i> On this section</button>
  <button id="article-nav-toc-btn"><i class="icon icon-toc"></i> On this page</button>
</nav>
      <header id="article-header">
  <h1>RBAC</h1>
</header>
      <div id="article-content">
        
        
        <h4 id="role-based-access-control-rbac">Role Based Access Control (RBAC)</h4>
<p>Role-Based Access Control (RBAC) in Kubernetes is a method of regulating access to computer or network resources based on the roles of individual users within an enterprise. In the context of Kubernetes, RBAC allows you to control who has access to the Kubernetes API and what they can do with those resources</p>
<pre><code>- Rules: A rule is a set of operations (verbs) that can be carried out on a group of resources which belong to different API Groups.
</code></pre>
<h5 id="kubectl-explain-rolerules">kubectl explain role.rules</h5>
<pre><code>```
 kubectl explain role.rules     
</code></pre>
<p>GROUP:      rbac.authorization.k8s.io
KIND:       Role
VERSION:    v1</p>
<p>FIELD: rules &lt;[]PolicyRule&gt;</p>
<p>DESCRIPTION:
Rules holds all the PolicyRules for this Role
PolicyRule holds information that describes a policy rule, but does not
contain information about who the rule applies to or which namespace the
rule applies to.</p>
<p>FIELDS:
apiGroups     &lt;[]string&gt;
APIGroups is the name of the APIGroup that contains the resources.  If
multiple API groups are specified, any action requested against one of the
enumerated resources in any API group will be allowed. &quot;&quot; represents the
core API group and &ldquo;*&rdquo; represents all API groups.</p>
<p>nonResourceURLs       &lt;[]string&gt;
NonResourceURLs is a set of partial urls that a user should have access to.
*s are allowed, but only as the full, final step in the path Since
non-resource URLs are not namespaced, this field is only applicable for
ClusterRoles referenced from a ClusterRoleBinding. Rules can either apply to
API resources (such as &ldquo;pods&rdquo; or &ldquo;secrets&rdquo;) or non-resource URL paths (such
as &ldquo;/api&rdquo;),  but not both.</p>
<p>resourceNames &lt;[]string&gt;
ResourceNames is an optional white list of names that the rule applies to.
An empty set means that everything is allowed.</p>
<p>resources     &lt;[]string&gt;
Resources is a list of resources this rule applies to. &lsquo;*&rsquo; represents all
resources.</p>
<p>verbs &lt;[]string&gt; -required-
Verbs is a list of Verbs that apply to ALL the ResourceKinds contained in
this rule. &lsquo;*&rsquo; represents all verbs.</p>
<pre><code>```

- Roles and ClusterRoles: Both consist of rules. The difference between a Role and a ClusterRole is the scope: in a Role, the rules are applicable to a single namespace, whereas a ClusterRole is cluster-wide, so the rules are applicable to more than one namespace. ClusterRoles can define rules for cluster-scoped resources (such as nodes) as well. Both Roles and ClusterRoles are mapped as API Resources inside our cluster.
</code></pre>
<h5 id="kubectl-explain-role">kubectl explain role</h5>
<pre><code>```
</code></pre>
<p>kubernetesdaily.github.io git:(main) ✗ kubectl explain role   <br>
GROUP:      rbac.authorization.k8s.io
KIND:       Role
VERSION:    v1</p>
<p>DESCRIPTION:
Role is a namespaced, logical grouping of PolicyRules that can be referenced
as a unit by a RoleBinding.</p>
<p>FIELDS:
apiVersion    <!-- raw HTML omitted -->
APIVersion defines the versioned schema of this representation of an object.
Servers should convert recognized schemas to the latest internal value, and
may reject unrecognized values. More info:
<a href="https://git.k8s.io/community/contributors/devel/sig-architecture/api-conventions.md#resources" target="_blank">https://git.k8s.io/community/contributors/devel/sig-architecture/api-conventions.md#resources</a></p>
<p>kind  <!-- raw HTML omitted -->
Kind is a string value representing the REST resource this object
represents. Servers may infer this from the endpoint the client submits
requests to. Cannot be updated. In CamelCase. More info:
<a href="https://git.k8s.io/community/contributors/devel/sig-architecture/api-conventions.md#types-kinds" target="_blank">https://git.k8s.io/community/contributors/devel/sig-architecture/api-conventions.md#types-kinds</a></p>
<p>metadata      <!-- raw HTML omitted -->
Standard object&rsquo;s metadata.</p>
<p>rules &lt;[]PolicyRule&gt;
Rules holds all the PolicyRules for this Role</p>
<pre><code>```
</code></pre>
<h5 id="kubectl-explain-clusterroles">kubectl explain clusterroles</h5>
<pre tabindex="0"><code>kubernetesdaily.github.io git:(main) ✗ kubectl explain clusterroles
GROUP:      rbac.authorization.k8s.io
KIND:       ClusterRole
VERSION:    v1

DESCRIPTION:
    ClusterRole is a cluster level, logical grouping of PolicyRules that can be
    referenced as a unit by a RoleBinding or ClusterRoleBinding.
    
FIELDS:
  aggregationRule       &lt;AggregationRule&gt;
    AggregationRule is an optional field that describes how to build the Rules
    for this ClusterRole. If AggregationRule is set, then the Rules are
    controller managed and direct changes to Rules will be stomped by the
    controller.

  apiVersion    &lt;string&gt;
    APIVersion defines the versioned schema of this representation of an object.
    Servers should convert recognized schemas to the latest internal value, and
    may reject unrecognized values. More info:
    https://git.k8s.io/community/contributors/devel/sig-architecture/api-conventions.md#resources

  kind  &lt;string&gt;
    Kind is a string value representing the REST resource this object
    represents. Servers may infer this from the endpoint the client submits
    requests to. Cannot be updated. In CamelCase. More info:
    https://git.k8s.io/community/contributors/devel/sig-architecture/api-conventions.md#types-kinds

  metadata      &lt;ObjectMeta&gt;
    Standard object&#39;s metadata.

  rules &lt;[]PolicyRule&gt;
    Rules holds all the PolicyRules for this ClusterRole
</code></pre><pre><code>- Subjects: These correspond to the entity that attempts an operation in the cluster. There are three types of subjects:

- User Accounts: These are global, and meant for humans or processes living outside the cluster. There is no associated resource API Object in the Kubernetes cluster.

- Service Accounts: This kind of account is namespaced and meant for intra-cluster processes running inside pods, which want to authenticate against the API.

- Groups: This is used for referring to multiple accounts. There are some groups created by default such as cluster-admin (explained in later sections).

- RoleBindings and ClusterRoleBindings: Just as the names imply, these bind subjects to roles (i.e. the operations a given user can perform). As for Roles and ClusterRoles, the difference lies in the scope: a RoleBinding will make the rules effective inside a namespace, whereas a ClusterRoleBinding will make the rules effective in all namespaces.
</code></pre>
<h4 id="kubectl-explain-rolebinding">kubectl explain rolebinding</h4>
<pre><code>```
✗ kubectl explain rolebindings
</code></pre>
<p>GROUP:      rbac.authorization.k8s.io
KIND:       RoleBinding
VERSION:    v1</p>
<p>DESCRIPTION:
RoleBinding references a role, but does not contain it.  It can reference a
Role in the same namespace or a ClusterRole in the global namespace. It adds
who information via Subjects and namespace information by which namespace it
exists in.  RoleBindings in a given namespace only have effect in that
namespace.</p>
<p>FIELDS:
apiVersion    <!-- raw HTML omitted -->
APIVersion defines the versioned schema of this representation of an object.
Servers should convert recognized schemas to the latest internal value, and
may reject unrecognized values. More info:
<a href="https://git.k8s.io/community/contributors/devel/sig-architecture/api-conventions.md#resources" target="_blank">https://git.k8s.io/community/contributors/devel/sig-architecture/api-conventions.md#resources</a></p>
<p>kind  <!-- raw HTML omitted -->
Kind is a string value representing the REST resource this object
represents. Servers may infer this from the endpoint the client submits
requests to. Cannot be updated. In CamelCase. More info:
<a href="https://git.k8s.io/community/contributors/devel/sig-architecture/api-conventions.md#types-kinds" target="_blank">https://git.k8s.io/community/contributors/devel/sig-architecture/api-conventions.md#types-kinds</a></p>
<p>metadata      <!-- raw HTML omitted -->
Standard object&rsquo;s metadata.</p>
<p>roleRef       <!-- raw HTML omitted --> -required-
RoleRef can reference a Role in the current namespace or a ClusterRole in
the global namespace. If the RoleRef cannot be resolved, the Authorizer must
return an error. This field is immutable.</p>
<p>subjects      &lt;[]Subject&gt;
Subjects holds references to the objects the role applies to.</p>
<pre tabindex="0"><code>#### kubectl explain clusterrolebindings
</code></pre><p>kubectl explain clusterrolebindings
GROUP:      rbac.authorization.k8s.io
KIND:       ClusterRoleBinding
VERSION:    v1</p>
<p>DESCRIPTION:
ClusterRoleBinding references a ClusterRole, but not contain it.  It can
reference a ClusterRole in the global namespace, and adds who information
via Subject.</p>
<p>FIELDS:
apiVersion    <!-- raw HTML omitted -->
APIVersion defines the versioned schema of this representation of an object.
Servers should convert recognized schemas to the latest internal value, and
may reject unrecognized values. More info:
<a href="https://git.k8s.io/community/contributors/devel/sig-architecture/api-conventions.md#resources" target="_blank">https://git.k8s.io/community/contributors/devel/sig-architecture/api-conventions.md#resources</a></p>
<p>kind  <!-- raw HTML omitted -->
Kind is a string value representing the REST resource this object
represents. Servers may infer this from the endpoint the client submits
requests to. Cannot be updated. In CamelCase. More info:
<a href="https://git.k8s.io/community/contributors/devel/sig-architecture/api-conventions.md#types-kinds" target="_blank">https://git.k8s.io/community/contributors/devel/sig-architecture/api-conventions.md#types-kinds</a></p>
<p>metadata      <!-- raw HTML omitted -->
Standard object&rsquo;s metadata.</p>
<p>roleRef       <!-- raw HTML omitted --> -required-
RoleRef can only reference a ClusterRole in the global namespace. If the
RoleRef cannot be resolved, the Authorizer must return an error. This field
is immutable.</p>
<p>subjects      &lt;[]Subject&gt;
Subjects holds references to the objects the role applies to.</p>
<pre tabindex="0"><code>
With Minikube, you can experiment with RBAC in a local Kubernetes setup. Minikube comes with RBAC enabled by default if you start it with a Kubernetes version that supports RBAC
</code></pre><p>✗ minikube start
😄  minikube v1.30.1 on Darwin 14.1.1 (arm64)
🎉  minikube 1.32.0 is available! Download it: <a href="https://github.com/kubernetes/minikube/releases/tag/v1.32.0" target="_blank">https://github.com/kubernetes/minikube/releases/tag/v1.32.0</a>
💡  To disable this notice, run: &lsquo;minikube config set WantUpdateNotification false&rsquo;</p>
<p>✨  Using the docker driver based on existing profile
👍  Starting control plane node minikube in cluster minikube
🚜  Pulling base image &hellip;
🔄  Restarting existing docker container for &ldquo;minikube&rdquo; &hellip;
🐳  Preparing Kubernetes v1.26.3 on Docker 23.0.2 &hellip;
🔗  Configuring Flannel (Container Networking Interface) &hellip;
🌟  Enabled addons:
🔎  Verifying Kubernetes components&hellip;
👍  Starting worker node minikube-m02 in cluster minikube
🚜  Pulling base image &hellip;
🔄  Restarting existing docker container for &ldquo;minikube-m02&rdquo; &hellip;
🌐  Found network options:
▪ NO_PROXY=192.168.49.2
🐳  Preparing Kubernetes v1.26.3 on Docker 23.0.2 &hellip;
▪ env NO_PROXY=192.168.49.2
🔎  Verifying Kubernetes components&hellip;
🏄  Done! kubectl is now configured to use &ldquo;minikube&rdquo; cluster and &ldquo;default&rdquo; namespace by default</p>
<pre tabindex="0"><code>
#### Create new namespace 

Execute the kubectl create command to create the namespace (as the admin user):
    
</code></pre><p>kubernetesdaily.github.io git:(main) ✗ kubectl create namespace kubedaily
namespace/kubedaily created</p>
<pre tabindex="0"><code>
#### Create the user credentials

genarete the user credentials using openssl command 
</code></pre><p>openssl genrsa -out kubedaily.key 2048
Generating RSA private key, 2048 bit long modulus
&hellip;&hellip;&hellip;&hellip;&hellip;&hellip;&hellip;&hellip;&hellip;&hellip;&hellip;&hellip;&hellip;&hellip;&hellip;&hellip;&hellip;&hellip;&hellip;&hellip;&hellip;.+++++
&hellip;&hellip;&hellip;&hellip;&hellip;&hellip;&hellip;&hellip;&hellip;&hellip;&hellip;&hellip;&hellip;&hellip;&hellip;&hellip;&hellip;&hellip;&hellip;&hellip;&hellip;&hellip;&hellip;&hellip;&hellip;..+++++
e is 65537 (0x10001)</p>
<pre tabindex="0"><code>Create a certificate sign request  using openssl command 
</code></pre><p>kubernetesdaily.github.io git:(main) ✗ openssl req -new -key kubedaily.key -out kubedaily.csr -subj &ldquo;/CN=kubedaily/O=sangam&rdquo;</p>
<pre tabindex="0"><code> 
</code></pre><p>➜  .minikube ls
addons              ca.pem              certs               key.pem             machine_client.lock proxy-client-ca.crt
ca.crt              cache               config              last_update_check   machines            proxy-client-ca.key
ca.key              cert.pem            files               logs                profiles            tunnels.json</p>
<pre tabindex="0"><code></code></pre><p>kubernetesdaily.github.io git:(main) ✗ kubectl config set-credentials kubedaily &ndash;client-certificate=/.certs/kubedaily.crt  &ndash;client-key=/.certs/kubedaily.key
User &ldquo;kubedaily&rdquo; set.
kubectl config set-context kubedaily-context &ndash;cluster=minikube &ndash;namespace=kubedaily &ndash;user=sangam</p>
<pre tabindex="0"><code>Now you should get an access denied error when using the kubectl CLI with this configuration file. This is expected as we have not defined any permitted operations for this user.
</code></pre><p>kubectl &ndash;context=kubedaily-context get pods</p>
<pre tabindex="0"><code>
####  Create the role for managing deployments
</code></pre><p>kind: Role
apiVersion: rbac.authorization.k8s.io/v1
metadata:
namespace: kubedaily
name: sangam
rules:</p>
<ul>
<li>apiGroups: [&quot;&quot;, &ldquo;extensions&rdquo;, &ldquo;apps&rdquo;]
resources: [&ldquo;deployments&rdquo;, &ldquo;replicasets&rdquo;, &ldquo;pods&rdquo;]
verbs: [&ldquo;get&rdquo;, &ldquo;list&rdquo;, &ldquo;watch&rdquo;, &ldquo;create&rdquo;, &ldquo;update&rdquo;, &ldquo;patch&rdquo;, &ldquo;delete&rdquo;] # You can also use [&quot;*&quot;]</li>
</ul>
<pre tabindex="0"><code>
#### Create the role binding
</code></pre><p>kind: RoleBinding
apiVersion: rbac.authorization.k8s.io/v1
metadata:
name: sangam-binding
namespace: kubedaily
subjects:</p>
<ul>
<li>kind: User
name: sangam
apiGroup: &quot;&quot;
roleRef:
kind: Role
name: sangam
apiGroup: &quot;&quot;</li>
</ul>
<pre tabindex="0"><code></code></pre><p>➜  kubernetesdaily.github.io git:(main) ✗ kubectl create -f rolebinding-deployment-manager.yaml
rolebinding.rbac.authorization.k8s.io/sangam-binding created</p>
<pre tabindex="0"><code></code></pre>
      </div>
      








  
  
  
        

        
          
        

      
    
        

        
          
        

      
    
        

        
          
        

      
    
        

        
          
        

      
    
        

        
          
        

      
    
        

        
          
        

      
    
        

        
          
        

      
    
        

        
          
        

      
    
        

        
          
        

      
    
        

        
          
        

      
    
        

        
          
        

      
    


<footer id="article-footer">
  <time id="article-last-updated" datetime="2023-12-01"><i class="icon icon-calendar"></i>&nbsp;Last updated: 2023-12-01</time>

  
    <a id="article-prev-link" href="/k8s/configmap/"><i class="icon icon-prev icon-colored"></i> Prev</a>
  

  
</footer>
    </article>
    <aside id="toc">
  <span class="btn-close"><i class="icon icon-close"></i></span>
  <div class="sticky">
    <strong><i class="icon icon-toc"></i> On this page</strong>
    <nav id="TableOfContents">
  <ul>
    <li>
      <ul>
        <li></li>
      </ul>
    </li>
  </ul>
</nav>
  </div>
</aside>
  </main>
</div>

    <footer id="site-footer">
  
  <div id="site-footer-copyright">
    <a href="https://discord.gg/rEvr7vq" target="_blank">
      <i class="icon icon-copyright"></i> 2023 CloudNativeFolks
    </a>
  </div>

  
  <div id="site-footer-social">

    

    
    <a href="https://twitter.com/i/communities/1499311438745468931" target="_blank" aria-label="twitter url">
      <i class="icon icon-twitter icon-colored"></i>
    </a>
    

    
    <a href="https://github.com/sangam14" target="_blank" aria-label="github url">
      <i class="icon icon-github icon-colored"></i>
    </a>
    

    
    <a href="https://www.youtube.com/@CloudNativeFolks" target="_blank" aria-label="youtube url">
      <i class="icon icon-youtube icon-colored"></i>
    </a>
    

  </div>

  
  <center> <a href="https://visitorbadge.io/status?path=https%3A%2F%2Fkubedaily.com"><img src="https://api.visitorbadge.io/api/visitors?path=https%3A%2F%2Fkubedaily.com&label=KubeDaily&labelColor=%232ccce4&countColor=%2337d67a" /></a> </center> 

  
  <div id="site-footer-love">
    Made with <i class="icon icon-love icon-colored"></i> &nbsp;from&nbsp;<a href="https://blog.cloudnativefolks.org" target="_blank">@CloudNativeFollks</a>
  </div>
</footer>
    






<script type="text/javascript" src="/js/base.min.js"></script>



  
  <script src="/js/component/docsearch.min.js"></script>
  <script type="application/javascript">
      docsearch({
          container: '#site-header-search',
          appId: '',
          indexName: '',
          apiKey: '',
      });
  </script>


<script type="application/javascript">
    if('serviceWorker' in navigator) {
        navigator.serviceWorker.register('/sw.js?2023-12-03')
            .catch(function(err) {console.error('ServiceWorker registration failed: ', err);});
    }
</script>
  </body>
</html>